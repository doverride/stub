(sid devnull)

(typeattribute dev_object)
(typeattribute dev_unconfined_subject)

(block dev
    (blockabstract dev)
        (type t)
        (call dev_object (t))
)

(in o
    (block dev
        (block apm
            (blockinherit dev)
        )

        (block autofs
            (blockinherit dev)
        )

        (block clock
            (blockinherit dev)
        )

        (block console
            (blockinherit dev)
        )

        (block cpu
            (blockinherit dev)
        )

        (block devtty
            (blockinherit dev)
        )

        (block dri
            (blockinherit dev)
        )

        (block event
            (blockinherit dev)
        )

        (block framebuf
            (blockinherit dev)
        )

        (block kmsg
            (blockinherit dev)
        )

        (block loop_control
            (blockinherit dev)
        )

        (block lvm_control
            (blockinherit dev)
        )

        (block memory
            (blockinherit dev)
        )

        (block mouse
            (blockinherit dev)
        )

        (block net_control
            (blockinherit dev)
        )

        (block null
            (blockinherit dev)
        )

        (block nvram
            (blockinherit dev)
        )

        (block ppp
            (blockinherit dev)
        )

        (block ptmx
            (blockinherit dev)
        )

        (block random
            (blockinherit dev)
        )

        (block sound
            (blockinherit dev)
        )

        (block tun_tap
            (blockinherit dev)
        )

        (block uhid
            (blockinherit dev)
        )

        (block urandom
            (blockinherit dev)
        )

        (block usb
            (blockinherit dev)
        )

        (block usbmon
            (blockinherit dev)
        )

        (block v4l
            (blockinherit dev)
        )

        (block vfio
            (blockinherit dev)
        )

        (block vhci
            (blockinherit dev)
        )

        (block vhost
            (blockinherit dev)
        )

        (block wireless
            (blockinherit dev)
        )

        (block xserver_misc
            (blockinherit dev)
        )

        (block zero
            (blockinherit dev)
        )
    )
)

(call fs_associate_devtmpfs_object (dev_object))

(allow dev_unconfined_subject dev_object (chr_file (all)))
(allow dev_unconfined_subject dev_object (blk_file (all)))

(macro dev_object ((type ARG1))
    (call object (ARG1))
    (typeattributeset dev_object ARG1))

(macro dev_unconfined_subject ((type ARG1))
    (typeattributeset dev_unconfined_subject ARG1))

(context dev_apm (s.sys.u o.r o.dev.apm.t (systemlow systemlow)))

(filecon "/dev/snapshot" char dev_apm)

(context dev_autofs (s.sys.u o.r o.dev.autofs.t (systemlow systemlow)))

(filecon "/dev/autofs" char dev_autofs)

(context dev_clock (s.sys.u o.r o.dev.clock.t (systemlow systemlow)))

(filecon "/dev/hpet" char dev_clock)
(filecon "/dev/rtc[0-9]+" char dev_clock)

(context dev_console (s.sys.u o.r o.dev.console.t (systemlow systemlow)))

(filecon "/dev/console" char dev_console)

(context dev_cpu (s.sys.u o.r o.dev.cpu.t (systemlow systemlow)))

(filecon "/dev/cpu/.+" char dev_cpu)

(context dev_devtty (s.sys.u o.r o.dev.devtty.t (systemlow systemlow)))

(filecon "/dev/tty" char dev_devtty)

(context dev_dri (s.sys.u o.r o.dev.dri.t (systemlow systemlow)))

(filecon "/dev/dri/.+" char dev_dri)

(context dev_event (s.sys.u o.r o.dev.event.t (systemlow systemlow)))

(filecon "/dev/input/event[0-9]+" char dev_event)
(filecon "/dev/uinput" char dev_event)

(context dev_framebuf (s.sys.u o.r o.dev.framebuf.t (systemlow systemlow)))

(filecon "/dev/fb[0-9]+" char dev_framebuf)

(context dev_kmsg (s.sys.u o.r o.dev.kmsg.t (mls_systemhigh mls_systemhigh)))

(filecon "/dev/kmsg" char dev_kmsg)
(filecon "/dev/mcelog" char dev_kmsg)

(context dev_loop_control (s.sys.u o.r o.dev.loop_control.t (systemlow systemlow)))

(filecon "/dev/loop-control" char dev_loop_control)

(context dev_lvm_control (s.sys.u o.r o.dev.lvm_control.t (systemlow systemlow)))

(filecon "/dev/btrfs-control" char dev_lvm_control)
(filecon "/dev/mapper/control" char dev_lvm_control)

(context dev_memory (s.sys.u o.r o.dev.memory.t (mls_systemhigh mls_systemhigh)))

(filecon "/dev/mem" char dev_memory)
(filecon "/dev/port" char dev_memory)

(context dev_mouse (s.sys.u o.r o.dev.mouse.t (systemlow systemlow)))

(filecon "/dev/input/mice" char dev_mouse)
(filecon "/dev/input/mouse[0-9]+" char dev_mouse)

(context dev_net_control (s.sys.u o.r o.dev.net_control.t (systemlow systemlow)))

(filecon "/dev/cpu_dma_latency" char dev_net_control)
(filecon "/dev/network_latency" char dev_net_control)
(filecon "/dev/network_throughput" char dev_net_control)

(context dev_null (s.sys.u o.r o.dev.null.t (systemlow systemlow)))

(sidcontext devnull dev_null)

(filecon "/dev/full" char dev_null)
(filecon "/dev/null" char dev_null)

(context dev_nvram (s.sys.u o.r o.dev.nvram.t (mls_systemhigh mls_systemhigh)))

(filecon "/dev/nvram" char dev_nvram)

(context dev_ppp (s.sys.u o.r o.dev.ppp.t (systemlow systemlow)))

(filecon "/dev/ppp" char dev_ppp)

(context dev_ptmx (s.sys.u o.r o.dev.ptmx.t (systemlow systemlow)))

(filecon "/dev/ptmx" char dev_ptmx)

(context dev_random (s.sys.u o.r o.dev.random.t (systemlow systemlow)))

(filecon "/dev/random" char dev_random)

(context dev_sound (s.sys.u o.r o.dev.sound.t (systemlow systemlow)))

(filecon "/dev/snd/.+" char dev_sound)

(context dev_tun_tap (s.sys.u o.r o.dev.tun_tap.t (systemlow systemlow)))

(filecon "/dev/net/tun" char dev_tun_tap)

(context dev_uhid (s.sys.u o.r o.dev.uhid.t (systemlow systemlow)))

(filecon "/dev/uhid" char dev_uhid)

(context dev_urandom (s.sys.u o.r o.dev.urandom.t (systemlow systemlow)))

(filecon "/dev/urandom" char dev_urandom)

(context dev_usb (s.sys.u o.r o.dev.usb.t (systemlow systemlow)))

(filecon "/dev/bus/usb/.+" char dev_usb)
(filecon "/dev/hidraw[0-9]+" char dev_usb)

(context dev_usbmon (s.sys.u o.r o.dev.usbmon.t (systemlow systemlow)))

(filecon "/dev/usbmon[0-9]+" char dev_usbmon)

(context dev_v4l (s.sys.u o.r o.dev.v4l.t (systemlow systemlow)))

(filecon "/dev/media[0-9]+" char dev_v4l)
(filecon "/dev/video[0-9]+" char dev_v4l)

(context dev_vfio (s.sys.u o.r o.dev.vfio.t (systemlow systemlow)))

(filecon "/dev/vfio/.+" char dev_vfio)

(context dev_vhci (s.sys.u o.r o.dev.vhci.t (systemlow systemlow)))

(filecon "/dev/vhci" char dev_vhci)

(context dev_vhost (s.sys.u o.r o.dev.vhost.t (systemlow systemlow)))

(filecon "/dev/vhost-net" char dev_vhost)

(context dev_wireless (s.sys.u o.r o.dev.wireless.t (systemlow systemlow)))

(filecon "/dev/rfkill" char dev_wireless)

(context dev_xserver_misc (s.sys.u o.r o.dev.xserver_misc.t (systemlow systemlow)))

(filecon "/dev/vga_arbiter" char dev_xserver_misc)

(context dev_zero (s.sys.u o.r o.dev.zero.t (systemlow systemlow)))

(filecon "/dev/zero" char dev_zero)
